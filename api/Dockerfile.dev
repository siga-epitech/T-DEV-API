FROM node:18-alpine

# Définir bash comme shell par défaut
SHELL ["/bin/bash", "-c"]

# Ajouter les outils nécessaires et tester la connectivité réseau
RUN apk add --no-cache --update bind-tools bash iputils curl \
    && nslookup google.com \
    && ping -c 4 google.com

# Définir le répertoire de travail
WORKDIR /api

# Copier les fichiers package*.json et installer les dépendances
COPY package*.json ./
RUN npm install lodash

# Copier le reste des fichiers
COPY . .

# Exposer le port 3000 (ou un autre port selon ton application)
EXPOSE 3000

# Démarrer l'application
CMD ["npm", "start"]
